---
title: Steam商店在中国大陆被干扰（已证实）
date: 2022-01-29
tags: Steam
categories: article
---

## 摘要

自 2021-12-25 左右，Steam 商店开始遭到来自中国《网络数据安全管理条例（征求意见稿）》所谓“数据跨境安全网关”的 SNI 阻断攻击。具体表现为随机出现但持续一段时间的网页加载失败，客户端错误代码大部分为-118。此现象已持续足够长时间，可以认定此攻击非“误操作”或 Steam 方面故障导致。

## 相关报道

[Steam 商店 store.steampowered.com 疑似 443 端口被干扰？ ICMP 80 端口均正常 - V2EX](https://www.v2ex.com/t/824179)

[简报：Steam 商店疑似出现访问故障（已证实）]({% post_url 2021-12-25-steam-banned %})

## 测试工具包

[lwd-temp/steam-store-checker: Steam 商店 store.steampowered.com 疑似 443 端口被干扰验证 (github.com)](https://github.com/lwd-temp/steam-store-checker)

[直接下载工具包](https://github.com/lwd-temp/steam-store-checker/archive/refs/heads/main.zip)

## 适用于普通用户的简易复现方法

尝试打开 Steam 商店首页，不断打开从未浏览过的商品页面直到在某一时刻后打开的网页均无法正常加载，复现成功。

## 知识普及：SNI 阻断

### 《适用于互联网审查新手的 SNI 阻断技术实现指南》

#### 为什么我要使用 SNI 阻断技术？

随着 HTTPS 的普及，随意读取用户网络连接内容的时代已经一去不复返了，而邪恶的审查需求却与日俱增，我们需要灵活地阻止用户访问某个网站却又不易被用户发现，这意味着 DNS 污染不再可用。同时，同一个 IP 对应多个网站服务的情况也在增加，老式的针对 IP 封锁极有可能导致误封其他网站。不仅如此，上述老式方法非常容易被识别，非常容易带来难以预料的舆论风险。SNI 阻断技术具有灵活性强、部署简单迅速、可制造“故障”错觉等特点，且不容易在客户端取证，是您在新时代审查互联网的有力手段。

#### 什么是服务器名称指示（SNI）？

TLS 是网络通讯的安全基础（HTTPS）。TLS 提供的认证加密使得用户可以确定他们在与谁通讯， 并确保通讯信息不被中间人看到或篡改。 虽然 TLS 可以隐藏用户通讯的 _内容_ ，但其并不能总是隐藏与用户通讯的 _对象_ 。 比如 TLS 握手可以携带一个叫做加密服务器名称指示（SNI）的扩展, 这个扩展帮助客户端告诉服务器其想要访问的网站的域名。[来源](https://gfw.report/blog/gfw_esni_blocking/zh/)

#### 为什么我可以通过 SNI 阻断特定连接？

通过 Wireshark 软件获取网络数据包可以清晰地了解此问题。

以访问本站为例，当 TLS 连接建立时，客户端会先向服务器端发送 Client Hello，其内容如下。

```
0000   dc fe 18 16 ec 20 d2 78 bf 0d c6 fe 08 00 45 00   ..... .x......E.
0010   02 2d bb 0c 40 00 80 06 00 00 c0 a8 01 6f 68 15   .-..@........oh.
0020   38 b1 c0 c1 01 bb b5 c6 96 c8 65 db 3f af 50 18   8.........e.?.P.
0030   02 02 64 fd 00 00 16 03 01 02 00 01 00 01 fc 03   ..d.............
0040   03 be 22 2b b5 0b 51 85 8c d5 5f c8 17 62 7a 8c   .."+..Q..._..bz.
0050   2e 9f cb 05 9f 8d 03 8f 31 dd 66 a7 b7 e3 9d c9   ........1.f.....
0060   6f 20 b7 d9 59 fc 5d 9f ca 5e 18 6d 4e c8 2f f9   o ..Y.]..^.mN./.
0070   15 28 66 53 0b 6f 4f aa f0 43 dd e7 06 8f 6d 2f   .(fS.oO..C....m/
0080   0d ed 00 20 13 01 13 02 13 03 c0 2b c0 2f c0 2c   ... .......+./.,
0090   c0 30 cc a9 cc a8 c0 13 c0 14 00 9c 00 9d 00 2f   .0............./
00a0   00 35 00 ff 01 00 01 93 00 00 00 11 00 0f 00 00   .5..............
00b0   0c 6c 77 64 2d 74 65 6d 70 2e 74 6f 70 00 0b 00   .lwd-temp.top...
00c0   04 03 00 01 02 00 0a 00 08 00 06 00 1d 00 17 00   ................
00d0   18 00 23 00 00 00 05 00 05 01 00 00 00 00 00 10   ..#.............
00e0   00 0e 00 0c 02 68 32 08 68 74 74 70 2f 31 2e 31   .....h2.http/1.1
00f0   00 12 00 00 00 17 00 00 00 0d 00 12 00 10 04 03   ................
0100   08 04 04 01 05 03 08 05 05 01 08 06 06 01 00 2b   ...............+
0110   00 0b 0a 03 04 03 03 03 02 03 01 03 00 00 2d 00   ..............-.
0120   02 01 01 00 33 00 26 00 24 00 1d 00 20 68 23 ba   ....3.&.$... h#.
0130   5e e5 ff be f2 c2 2b 53 4f e5 e1 46 4e fb e4 e1   ^.....+SO..FN...
0140   6a b6 04 1e 25 0c ef eb d1 d7 8b ef 51 00 15 00   j...%.......Q...
0150   ea 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0160   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0170   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0180   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0190   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
01a0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
01b0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
01c0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
01d0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
01e0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
01f0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0200   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0210   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0220   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0230   00 00 00 00 00 00 00 00 00 00 00                  ...........

```

其中可见本站域名 lwd-temp.top，这说明 TLS“并不能总是隐藏与用户通讯的 _对象_ ”。使用此方法，我们可以大致确认一个用户（在实践中通常是用户群体）正在访问的网站域名。

#### 如何阻断已经识别出的连接？

通过上一段提到的方法，我们可以确定正在尝试访问对应网站的用户。通过针对此用户丢弃来自对应 IP 地址的数据包，我们可以轻松地完成我们的邪恶目标。

#### 我该如何降低舆论风险？

通过间歇性随机地识别并阻断连接，我们可以模拟出目标网站“故障”的假象。部分非专业人士会认为，目标服务的无法访问是由于服务器或自己设备的问题，一旦成功连接，便会认为目标服务没有被封锁，从而散布“一切安好”的消息。这类用户也可能会与部分专业人士在国内论坛上对抗，并指责对方“不爱国”、“质疑政府”，并运用其鸵鸟心态相信只要不声张就不会遭到封锁。

同时，在国内论坛要求控制“有关服务被封”、“有关服务被墙”、“有关服务无法打开”等内容，尽量降低发生此类问题的用户聚集讨论的可能性。

#### 温馨提示

SNI 阻断攻击是一种网络攻击手段，这在各种意义上说都是不道德、违背技术初心且违法的。

如果您不想在国际互联网上遗臭万年并被其他国家排挤、被认为是不可信的网络环境并被业内人士辱骂，请不要使用此方案。
